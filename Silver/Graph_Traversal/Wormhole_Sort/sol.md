Armamos un grafo donde un hoyo entre $i$ y $j$ implica que existe una arista entre $i$ y $j$. La clave está en darse cuenta que si un número no está en su posición, es necesario que exista un camino entre el número y el número que está en su posición. En otras palabras, ambos números deben estar en la misma componente. Se conoce que este algoritmo toma tiempo $O(M + N)$ usando recorridos como DFS. Es fácil notar que esto es una condición necesaria ya que si dicho camino no existe, no hay forma de llevar a un número a su posición correcta. La demostración que si los caminos existen es posible poner todos los números en su posición no es obvia. Una idea podría ser que se puede llegar a cualquier permutación lo que es algo más general.

Para hallar la mayor medida en la cuál es posible ubicar lo números podemos ordenar las aristas en base a su medida. Luego podemos iterar desde la mayor, tomando cada medida como máxima, construyendo el grafo ignorando medidas menores y verificando la condición descrita en base a las componentes conectadas. Iteramos hasta llegar al primer valor en el que la condición se cumpla. Esto toma $O(M \log M)$ + $O(M * (M + N))$ lo cual es tiempo $O(M^2 + M \times N)$. Con esto se puede pasar la primera subtarea.

Para optimizar el tiempo podemos utilizar búsqueda binaria para encontrar la mayor medida luego de ordenarlas, dando una complejidad asintótica de $O(\log M * (M + N))$
